// Use it like this:
// 1. extend a ractive component with ConfirmDeleteModal to add the show_confirm_delete_modal method
// 2. make the 'on-click' handler for the delete icon 'show_confirm_delete_modal()'
// 3. add a computed attribute to the object called delete_confirmation_message
// 4. ensure that the object has a url attribute as a rack endpoint for delete
// 5. ensure that the callback action for the delete method is called "delete_callback"
// 6. ensure that the object does not have its own delete method
#confirm_delete_modal_container

%script#confirm_delete_modal_template{:type => 'template/ractive'}
  .modal.fade#confirm-delete
    .modal-dialog.modal-sm
      .modal-content
        .modal-body
        .modal-footer
          %a.btn.btn-sm.btn-default#cancel{:type => :button, 'data-dismiss'=>'modal'}= t('cancel')
          %a.btn.btn-sm.btn-danger.btn-ok#confirm{'on-click' => 'delete_item()'}= t('delete')

:coffeescript
  confirm_delete_modal = new Ractive
    el : '#confirm_delete_modal_container'
    template : '#confirm_delete_modal_template'
    data :
      deletable : null
      url : null
      message : null
      callback : null
    show : ->
      $(@el).find('.modal#confirm-delete').modal('show')
      $(@el).find('.modal#confirm-delete').find('.modal-body').html(@get('message'))
    hide : ->
      $(@el).find('.modal#confirm-delete').modal('hide')
    success_callback : (response, statusText, jqxhr)->
      @hide()
      @get('callback').apply(@get('deletable'),[response, statusText, jqxhr])
    error_callback : ->
      console.log "error callback"
    delete_item : ->
      -#ev = $.Event(event)
      -#ev.stopPropagation()
      data = [{name:'_method', value: 'delete'}]
      $.ajax
        url : @get('url')
        data : data
        method : 'post'
        dataType : 'json'
        context : @
        success : @success_callback
        error : @error_callback

  @ConfirmDeleteModal =
    show_confirm_delete_modal : ()->
      confirm_delete_modal.set
        deletable : @
        url : @get('url')
        message : @get('delete_confirmation_message')
        callback : @delete_callback
      confirm_delete_modal.show()
      return
