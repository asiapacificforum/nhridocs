//%script{:src=>'http://cdn.ractivejs.org/latest/ractive.js'}
= javascript_include_tag 'corporate_services/ractive'

= select :strategic_plan, :start_date, start_date_options, {}, {:class => "form-control h1_select", :style => "background-color:inherit;height:50px"}

%table.table
  %tr
    %td{:colspan => 7}
      %span.btn.btn-success.add_strategic_priority{'data-toggle' => 'modal', 'data-target'=>'#new_strategic_priority'}
        %i.fa.fa-plus.fa-lg{:style => "color:white"}
        %span= t('.add_priority')

#accordion.panel-group#strategic_plan{:role => "tablist"}

= render :partial => 'strategic_priority_form'

:coffeescript
  $ ->
    # switch pages in response to changes in the title select box
    $('#strategic_plan_start_date').on 'change', ->
      url = "#{corporate_services_strategic_plan_path(:en,:id)}".replace(/id$/,@.value)
      $.get( url, null, set_data, 'json')

    set_data = (data,status,jqxhr)->
      strategic_plan.set(data)
      strategic_priority_form.update('spid') # wish this was not necessary. computed attr should know that dependency changed
