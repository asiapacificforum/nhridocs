%script#media_appearances_template{:type => 'template/ractive'}
  .row#media_appearances_controls
    .row
      .col-md-4
        %h4= t('.search_heading')
    .row.labels
      .col-md-2= t('.title')
      .col-md-2= t('.from')
      .col-md-2= t('.to')
      .col-md-2
        =t('.area')
        \/
        =t('.subarea')
    .row{:style => "margin-bottom:12px;"}
      .col-md-2= text_field_tag :title, "{{sort_criteria.title}}", :placeholder => t('.enter_text')
      .col-md-2
        %input{:type=>"text", :id=>"from", :name=>"from", :placeholder => t('.from_date'), :value => "{{formatted_from_date}}"}
      .col-md-2
        %input{:type=>"text", :id=>"to", :name=>"to", :placeholder => t('.to_date'), :value => "{{formatted_to_date}}"}
      .col-md-3
        .btn-group.area-select
          %button.btn.btn-default.dropdown-toggle{:type=>:button, 'data-toggle'=>'dropdown'}
            %span.filter-option.pull-left= t('.select')
            %span.caret
          %ul.dropdown-menu
            %li.filter_rule
              %a{'on-click'=>"filter_rule('all')", :class => "{{#if sort_criteria.rule == 'all'}}selected{{/if}}"}
                %span=t('.all')
                %span.fa.fa-check
              %a{'on-click'=>"filter_rule('any')", :class => "{{#if sort_criteria.rule == 'any'}}selected{{/if}}"}
                %span=t('.any')
                %span.fa.fa-check
            {{#areas}}
            <area id='{{id}}' name='{{name}}'/>
            {{/areas}}
      .col-md-1
        %i.erase.fa.fa-refresh{'on-click'=>'clear_filter()', 'data-toggle'=>'tooltip', 'title' => 'Clear filter'}
      .col-md-1
        {{#if expanded}}
        %a#compact{'on-click'=>'compact()', 'data-toggle'=>'tooltip', 'title'=>'Compact all'}
        {{else}}
        %a#expand{'on-click'=>'expand()', 'data-toggle'=>'tooltip', 'title'=>'Expand all'}
        {{/if}}
    .row.labels
      .col-md-2= t('.people_affected')
      .col-md-2= t('.severity')
      .col-md-2= t('.coefficient')
      .col-md-2= t('.positivity')
    .row.labels
      .col-md-1= t('.min')
      .col-md-1= t('.max')
      .col-md-1= t('.min')
      .col-md-1= t('.max')
      .col-md-1= t('.min')
      .col-md-1= t('.max')
      .col-md-1= t('.min')
      .col-md-1= t('.max')
    .row
      .col-md-1.filter_field.pa_min
        %input{:style=>"width:80px", :value => '{{sort_criteria.pa_min}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.pa_max
        %input{:style=>"width:80px", :value => '{{sort_criteria.pa_max}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.vs_min
        %input{:style=>"width:50px", :value => '{{sort_criteria.vs_min}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.vs_max
        %input{:style=>"width:50px", :value => '{{sort_criteria.vs_max}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.vc_min
        %input{:style=>"width:50px", :value => '{{sort_criteria.vc_min}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.vc_max
        %input{:style=>"width:50px", :value => '{{sort_criteria.vc_max}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.pr_min
        %input{:style=>"width:50px", :value => '{{sort_criteria.pr_min}}'}
        %span.error_message Invalid
      .col-md-1.filter_field.pr_max
        %input{:style=>"width:50px", :value => '{{sort_criteria.pr_max}}'}
        %span.error_message Invalid
  {{#media_appearances}}
  <ma description='{{description}}'/>
  {{/media_appearances}}

%script#media_appearance_template{:type => 'template/ractive'}
  .row.media_appearance.well.well-sm{:style => "{{#if !include}}display:none{{/if}}"}
    .col-md-12
      .row.basic_info
        .col-md-2.date{:style => "width:15%"} {{ date }}
        .col-md-2.title{:style => "width:60%"} {{ title }}
        .col-md-2.actions{:style => "width:25%"}
          %div.alarm_icon{'on-click' => "show_reminders_panel()", :style => "position:relative; float:left; width:20px; top:3px; margin-left:20px;"}
          %i.fa.fa-file-text-o.show_notes{'on-click' => "show_notes_panel()", :style => "margin-left:28px; position:relative; float:left; top:3px;"}
          {{#if has_link }}
          %i.fa.fa-globe{ :style => "margin-left:28px; position:relative; float:left; top:3px;"}
          {{elseif has_scanned_doc }}
          %i.fa.fa-cloud-download{ :style => "margin-left:28px; position:relative; float:left; top:3px;"}
          {{/if}}
          %i.fa.fa-pencil-square-o{ :style => "margin-left:28px; position:relative; float:left; top:3px;"}
          %a{'data-toggle'=>:collapse, :href => ".collapse{{id}}"}
            %i.fa.fa-info-circle{ :style => "margin-left:28px; position:relative; float:left; top:3px;"}
      .panel.panel-default.collapse.expanded_info{:class => "collapse{{id}}"}
        .panel-heading
          .row
            .col-md-2.description{:style => "width:50%"}
              =t('.areas')
              \/
              =t('.subareas')
            .col-md-2.metrics{:style=>"width:25%;"}= t('.metrics')
        .panel-content
          .row
            .col-md-2.description{:style => "width:50%"}
              {{#media_areas}}
              <mediaarea>
              {{/media_areas}}
            .col-md-2.metrics{:style=>"width:25%; display:flex; flex-direction:column;"}
              {{#metrics:name}}
              .metric
                .name {{ name }}
                .value {{ metrics[name] }}
              {{/metrics}}
    <reminders>

%script#area_template{:type=> 'template/ractive'}
  %li{:class => 'area dropdown-header {{#if area_selected}}selected{{/if}}'}
    %a{'on-click'=>'toggle()'}
      %span {{name}}
      %span.fa.fa-check
  {{#subareas}}
  <subarea>
  {{/subareas}}

%script#subarea_template{:type=> 'template/ractive'}
  %li{:class => 'subarea {{#if subarea_selected}}selected{{/if}}'}
    %a.opt{'on-click'=>'toggle()'}
      %span.text {{name}}
      %span.fa.fa-check

%script#media_area_template{:type=> 'template/ractive'}
  .area
    .name {{ name }}
    .subareas
      {{#subarea_ids:i}}
      <mediasubarea id={{subarea_ids[i]}}>
      {{/subarea_ids}}

%script#media_subarea_template{:type=> 'template/ractive'}
  %span.subarea {{ name }}

%script#metric_template{:type => 'template/ractive'}
  .metric
    .name {{ name }}
    .value {{ value }}
